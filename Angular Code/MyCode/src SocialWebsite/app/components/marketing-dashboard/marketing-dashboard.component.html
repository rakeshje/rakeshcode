<!-- Start Right Bar -->
<app-rightsidemenu></app-rightsidemenu>
<!-- Close Right Bar -->

<!-- Satrt Page Content -->
<div class="page-wrap">
    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-md-3">
                <div class="left-menu card">
                    <app-sidemenu></app-sidemenu>
                </div>
            </div>

            <div class="col-md-9">
                <div class="page-content">
                    <div class="card post-box main-post">
                        <!-- <div class="card post-box post-search">
                                  <div class="post-wrap">
                                  <div class="visit-text">
                                      <h5>Recently Visited</h5>
                                  </div>
                                  <form class="search-form">
                                      <input type="text" placeholder="Search by job Name" class="form-control">
                                  </form>
                            </div>
                          </div> -->
                        <div class="card  post-search bidding">
                            <div class="post-wrap" style="width:100%;">
                                <form class="search-form">
                                    <input type="search" placeholder="Shop by product or product name "
                                        class="form-control" (keyup)="searchChange.next($event.target.value)">
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="card post-field main-post">
                        <div class=" heding-part">
                            <div class="tab bankingDetail wd">
                                <a class=" tablinks" [ngClass]="{'active': tabActive=='dashboard'}" (click)="changeTab('dashboard')">Dashboard</a>
                                <a class=" tablinks" [ngClass]="{'active': tabActive=='sell'}" (click)="changeTab('sell')">Sell</a>
                                <a class=" tablinks" [ngClass]="{'active': tabActive=='wishlist'}" (click)="changeTab('wishlist')">Wishlist</a>
                                <a class=" tablinks" [ngClass]="{'active': tabActive=='chats'}" (click)="changeTab('chats')">Chats</a>
                                <a class=" tablinks" [ngClass]="{'active': tabActive=='sellHistory'}" (click)="changeTab('sellHistory')">My sell history</a>
                                <a class=" tablinks" [ngClass]="{'active': tabActive=='orderHistory'}" (click)="changeTab('orderHistory')">Order history</a>
                            </div>
                        </div>

                        <div class="field-area" *ngIf="tabActive == 'dashboard'">
                            <div class="slider-div" *ngIf="bannerImages.length">
                                <div id="carouselExampleControls" class="carousel slide styleCarousel"
                                    data-ride="carousel">
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img [src]="image" class="d-block w-100 cart-image" alt="...">
                                        </div>
                                        <!-- <div class="carousel-item">
                                            <img src="assets/images/Layer 115.jpg" class="d-block w-100" alt="...">
                                        </div>
                                        <div class="carousel-item">
                                            <img src="assets/images/Layer 115.jpg" class="d-block w-100" alt="...">
                                        </div> -->
                                    </div>
                                    <a class="carousel-control-prev" (click)="changeImage(1)" role="button"
                                        data-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                    <a class="carousel-control-next" (click)="changeImage(2)" role="button"
                                        data-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </div>
                            </div>

                            <div class="bidding-row">
                                <div class="row mt-4">
                                    <div class="col-md-12 col-sm-12 col-lg-12 dressLook ">
                                        <h5>Browse popular Category</h5>
                                    </div>
                                    <div class="col-md-4 col-sm-4 col-lg-4 dressLook"
                                        *ngFor="let category of popularCategory | slice:0:5;"
                                        (click)="changeTab('sell')">
                                        <img class="popular" [src]="category?.image">
                                        <p>{{category?.categoryName}}</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4 col-lg-4 dressLook" (click)="changeTab('sell')"
                                        *ngIf="popularCategory.length>5">
                                        <img src="assets/images/Layer 115.jpg">
                                        <p>More</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4 col-lg-4 dressLook" *ngIf="!popularCategory.length">
                                        <p>No popular categories</p>
                                    </div>
                                    <div class="col-md-12 col-sm-12 col-lg-12 dressLook">
                                        <h5>Most Popular buying product</h5>
                                    </div>
                                    <div class="col-md-4 col-sm-4 col-lg-4 dressLook"
                                        *ngFor="let item of popularProduct | slice:0:5;"
                                        routerLink="/marketing-product">
                                        <img class="popular" *ngIf="item?.image || item?.productImages.length" [src]="item?.image ? item?.image : item?.productImages[0].image">
                                        <img *ngIf="!item?.image && !item?.productImages.length" class="popular" src="assets/images/Layer 115.jpg">
                                        <p>{{item?.productName}}</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4 col-lg-4 dressLook" routerLink="/marketing-product"
                                        *ngIf="popularProduct.length>5">
                                        <img src="assets/images/Layer 115.jpg">
                                        <p>More</p>
                                    </div>
                                    <div class="col-md-4 col-sm-4 col-lg-4 dressLook" *ngIf="!popularProduct.length">
                                        <p>No popular products</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card post-field main-post" *ngIf="tabActive == 'sell'">
                            <div class="bidding-body">
                                <div class="accordion wd" id="accordionExample">
                                    <div class="card" *ngFor="let category of categoryList">
                                        <div class="card-header" id="headingOne">
                                            <h2 class="mb-0">
                                                <div class="btn btn-link shz-clss">
                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="butn-img">
                                                                <img class="shopByCategory" [src]="category.image">
                                                                <!-- <p>{{category.categoryName}}</p> -->
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 catgeory-text">
                                                            <h5>{{category.categoryName}}</h5>
                                                        </div>
                                                        <div class="col-md-5 icon-box">
                                                            <div class="icon" data-toggle="collapse"
                                                                (click)="openSubCategory(category)" aria-expanded="true"
                                                                aria-controls="collapseOne">
                                                                <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </h2>
                                        </div>
                                        <div id="collapse{{category._id}}" class="collapse" aria-labelledby="headingOne"
                                            data-parent="#accordionExample">
                                            <div class="card-body">
                                                <ul class="list-group">
                                                    <li class="list-group-item" *ngFor="let sub of newCategoryList"><a
                                                            (click)="addProduct(sub, category)"
                                                            href="javascript:;">{{sub.categoryName}}</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card post-box main-post" *ngIf="tabActive == 'orderHistory'">
                            <div class="post-warp">
                                <div class="post-content">
                                    <div class="content-col" *ngIf="orderHistory.length">
                                        <div class="mainField" *ngFor="let order of orderHistory">
                                            
                                            <div class="userName" *ngFor="let data of order.productDescription">
                                                    <div class="user history">
                                                            <img [src]="!data.productImages.length ? 'assets/images/Layer 61.png' : data.productImages[0].image">
                                                        </div>
                                                <p style="font-weight: 500;"> Status: {{order.orderStatus}}
                                                    <p>
                                                        <p style="font-weight: 500;">{{data.productName}}
                                                            <p>
                                                                <p style="color: #989696; font-size: 15px;">
                                                                    ${{data.totalCost}}
                                                                    <div class="cancelBtnn">
                                                                        <button type="submit" class="btn btn-success order-place-btn" data-toggle="modal"
                                                                            *ngIf="order.orderStatus == 'Pending'"
                                                                            (click)="cancel(order,data)">Cancel</button>
                                                                        <button
                                                                            *ngIf="order.orderStatus == 'Delivered'" class="btn btn-success order-place-btn" (click)="cancel(order)">Return</button>
                                                                        <button class="btn btn-success order-place-btn"
                                                                            *ngIf="order.orderStatus == 'Delivered'">Feedback
                                                                            and rating</button>
                                                                    </div>
                                                                    <p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content-col" *ngIf="!orderHistory.length">
                                        <div class="mainField">No history found</div>
                                    </div>
                                </div>


                            </div>
                        </div>

                        <div class="card post-box main-post" *ngIf="tabActive == 'wishlist'">
                            <span *ngIf="wishlistedProducts.length">
                                <div class="card post-box main-post" *ngFor="let wishlist of wishlistedProducts">
                                    <div class="post-warp">
                                        <div class="post-content">
                                            <div class="product-summery">

                                                <div class="post-summry wishlist-img" style="position: relative;">
                                                    <img [src]="wishlist.productImages[0].image" class="img-fluid">
                                                    <img src="assets/images/cross.png"
                                                        (click)="removeFromWishlist(wishlist._id)"
                                                        style="position: absolute; width: 25px;">
                                                    <!-- <i class="fa fa-times-circle" (click)="removeFromWishlist(wishlist._id)"></i> -->
                                                </div>
                                            </div>
                                        </div>
                                        <div class="prodect-name">
                                            <div class="heart-icon">
                                                <div>
                                                    <h5>{{wishlist.productName}}</h5>
                                                    <h5>{{wishlist.description}}</h5>
                                                    <h5>${{wishlist.productCost}}</h5>
                                                    <p><i class="fas fa-map-marker-alt"></i>
                                                        {{wishlist.location}}, {{wishlist.state}}</p>
                                                </div>
                                                <div class="like-icon">
                                                    <p>{{wishlist.createdAt}}</p>
                                                    <button class="btn btn-success paynow"
                                                        (click)="addToCart(wishlist._id)">Add to cart</button>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </span>
                            <span *ngIf="!wishlistedProducts.length">
                                <div class="card post-box main-post" *ngIf="!wishlistedProducts.length">
                                    Your wishlist is empty
                                </div>
                            </span>
                        </div>

                        <div class="card post-box main-post" *ngIf="tabActive == 'sellHistory'">
                            <span *ngIf="sellingHistory.length">
                                <div class="post-warp" *ngFor="let data of sellingHistory">
                                    <div class="post-content">
                                        <div class="product-summery">
                                            <div class="post-summry wishlist-img">
                                                <img [src]="data?.productImages.length ? data?.productImages[0].image : 'assets/images/Layer 115.jpg'"
                                                    class="img-fluid cart-image">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="prodect-name">
                                        <div class="heart-icon mt-2">
                                            <div>
                                                <h5>{{data.productName}}</h5>
                                                <h5>{{data.description}}</h5>
                                                <h6> ${{data.productCost}}.00</h6>
                                                <p><i class="fas fa-map-marker-alt"></i>
                                                    {{data.location}}, {{data.state}}</p>
                                            </div>
                                            <div class="like-icon mt-2">
                                                <p>{{data.createdAt}}</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="description-sh">
                                        <h6><b>Status: </b>
                                            {{data.sellStatus}} <i class="fas fa-pencil-alt edit-icon-sh"
                                                (click)="editStatus(data)"></i>
                                        </h6>
                                    </div>
                                </div>
                            </span>
                            <span *ngIf="!sellingHistory.length">
                                <div class="card post-box main-post" *ngIf="!wishlistedProducts.length">
                                    No selling history
                                </div>
                            </span>
                        </div>

                        <div *ngIf="tabActive == 'chats'">
                            <div class=" heding-part">
                                <div class="tab bankingDetail wd">
                                    <a class=" tablinks" [ngClass]="{'active': chatTabActive=='all'}"
                                        (click)="changeChatTab('all')">All</a>
                                    <a class=" tablinks" [ngClass]="{'active': chatTabActive=='buying'}"
                                        (click)="changeChatTab('buying')">Buying</a>
                                    <a class=" tablinks" [ngClass]="{'active': chatTabActive=='selling'}"
                                        (click)="changeChatTab('selling')">Selling</a>
                                </div>
                            </div>

                            <div class="card post-box main-post" *ngIf="chatTabActive == 'all'">
                                <div class="card post-box main-post mt-2" *ngFor="let chat of chatList">
                                    <div class="post-warp" (click)="openChat(chat)">
                                        <div class="chat-list-box">
                                            <ul class="list-body">
                                                <li class="chat-list-1">
                                                    <div class="chat-list-img">
                                                        <img
                                                            [src]="chat?.receiverProfile ? chat?.receiverProfile : 'assets/images/profile.png'">
                                                        <div class="active-list"></div>
                                                    </div>
                                                    <div class="list-text">
                                                        <h5> {{chat?.receiverName}}</h5>
                                                        <p
                                                            *ngIf="chat.message[chat.message.length-1].mediaType == 'text'">
                                                            {{chat.message[chat.message.length-1].message}}</p>
                                                        <p
                                                            *ngIf="chat.message[chat.message.length-1].mediaType == 'image'">
                                                            Photo</p>
                                                    </div>
                                                </li>
                                                <li class="chat-list-2">{{chat.createdAt}}</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="card post-box main-post mt-2">
                                            <div class="post-warp" routerLink="/chat-conversation">
                                                <div class="chat-list-box">
                                                    <ul class="list-body">
                                                        <li class="chat-list-1">
                                                            <div class="chat-list-img">
                                                                <img src="assets/images/chai.jpeg">
                                                                <div class="active-list"></div>
                                                            </div>
                                                            <div class="list-text">
                                                                <h5> Adam Levine</h5>
                                                                <p>Hey....</p>
                                                            </div>
                                                        </li>
                                                        <li class="chat-list-2">14.25</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card post-box main-post mt-2">
                                            <div class="post-warp" routerLink="/chat-conversation">
                                                <div class="chat-list-box">
                                                    <ul class="list-body">
                                                        <li class="chat-list-1">
                                                            <div class="chat-list-img">
                                                                <img src="assets/images/chai.jpeg">
                                                                <div class="active-list"></div>
                                                            </div>
                                                            <div class="list-text">
                                                                <h5> Adam Levine</h5>
                                                                <p>Hey....</p>
                                                            </div>
                                                        </li>
                                                        <li class="chat-list-2">14.25</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card post-box main-post mt-2">
                                            <div class="post-warp" routerLink="/chat-conversation">
                                                <div class="chat-list-box">
                                                    <ul class="list-body">
                                                        <li class="chat-list-1">
                                                            <div class="chat-list-img">
                                                                <img src="assets/images/chai.jpeg">
                                                                <div class="active-non"></div>
                                                            </div>
                                                            <div class="list-text">
                                                                <h5> Adam Levine</h5>
                                                                <p>Hey....</p>
                                                            </div>
                                                        </li>
                                                        <li class="chat-list-2">14.25</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card post-box main-post mt-2">
                                            <div class="post-warp" routerLink="/chat-conversation">
                                                <div class="chat-list-box">
                                                    <ul class="list-body">
                                                        <li class="chat-list-1">
                                                            <div class="chat-list-img">
                                                                <img src="assets/images/chai.jpeg">
                                                                <div class="active-non"></div>
                                                            </div>
                                                            <div class="list-text">
                                                                <h5> Adam Levine</h5>
                                                                <p>Hey....</p>
                                                            </div>
                                                        </li>
                                                        <li class="chat-list-2">14.25</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="card post-box main-post mt-2">
                                            <div class="post-warp" routerLink="/chat-conversation">
                                                <div class="chat-list-box">
                                                    <ul class="list-body">
                                                        <li class="chat-list-1">
                                                            <div class="chat-list-img">
                                                                <img src="assets/images/chai.jpeg">
                                                                <div class="active-non"></div>
                                                            </div>
                                                            <div class="list-text">
                                                                <h5> Adam Levine</h5>
                                                                <p>Hey....</p>
                                                            </div>
                                                        </li>
                                                        <li class="chat-list-2">14.25</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div> -->
                            </div>
                            <div class="card post-box main-post" *ngIf="chatTabActive == 'buying'">
                                <div class="card post-box main-post mt-2" *ngFor="let chat of chatList">
                                    <div class="post-warp" (click)="openChat(chat)" *ngIf="chat.type == 'buying'">
                                        <div class="chat-list-box">
                                            <ul class="list-body">
                                                <li class="chat-list-1">
                                                    <div class="chat-list-img">
                                                        <img
                                                            [src]="chat?.receiverProfile ? chat?.receiverProfile : 'assets/images/profile.png'">
                                                        <div class="active-list"></div>
                                                    </div>
                                                    <div class="list-text">
                                                        <h5> {{chat?.receiverName}}</h5>
                                                        <p
                                                            *ngIf="chat.message[chat.message.length-1].mediaType == 'text'">
                                                            {{chat.message[chat.message.length-1].message}}</p>
                                                        <p
                                                            *ngIf="chat.message[chat.message.length-1].mediaType == 'image'">
                                                            Photo</p>
                                                    </div>
                                                </li>
                                                <li class="chat-list-2">{{chat.createdAt}}</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card post-box main-post" *ngIf="chatTabActive == 'selling'">
                                <div class="card post-box main-post mt-2" *ngFor="let chat of chatList">
                                    <div class="post-warp" (click)="openChat(chat)" *ngIf="chat.type == 'selling'">
                                        <div class="chat-list-box">
                                            <ul class="list-body">
                                                <li class="chat-list-1">
                                                    <div class="chat-list-img">
                                                        <img
                                                            [src]="chat?.receiverProfile ? chat?.receiverProfile : 'assets/images/profile.png'">
                                                        <div class="active-list"></div>
                                                    </div>
                                                    <div class="list-text">
                                                        <h5> {{chat?.receiverName}}</h5>
                                                        <p
                                                            *ngIf="chat.message[chat.message.length-1].mediaType == 'text'">
                                                            {{chat.message[chat.message.length-1].message}}</p>
                                                        <p
                                                            *ngIf="chat.message[chat.message.length-1].mediaType == 'image'">
                                                            Photo</p>
                                                    </div>
                                                </li>
                                                <li class="chat-list-2">{{chat.createdAt}}</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- dashboard content -->


            <!-- end -->

        </div>
    </div>
</div>

<!-- Cancel product Modal -->
<div class="modal fade" id="cancelProduct" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body detail-about">
                <form>
                    <input type="radio" name="gender" value="changeMyIdea" [(ngModel)]="reasonToCancel"> Change my Idea<br>
                    <input type="radio" name="gender" value="notGoodQuality" [(ngModel)]="reasonToCancel"> Not good quality<br>
                    <input type="radio" name="gender" value="other" [(ngModel)]="reasonToCancel"> Other
                </form>
                <!-- <div class="btnnns">
                    <div class="flexProp">
                        <button type="submit" (click)="hideModal('cancelProduct')" class="btn btn-danger btn-return" style="width: auto;">Cancel</button>
                        <button class="btn btn-success paynow" type="submit" (click)="cancelOrder()">Submit</button>
                    </div>
                </div> -->
            </div>
            <div class="modal-footer" style="border: none !important;">
                <div class="retur-product">
                    <button type="button" class="btn btn-danger btn-return" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success paynow btn-return" [disabled]="reasonToCancel == ''" (click)="cancelOrder()">Submit
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal End -->

<!-- Change status Modal -->
<div class="modal fade" id="changeStatus" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body detail-about">
                <form [formGroup]="changeStatusForm">
                    <input type="radio" name="status" value="available" formControlName="status"> Available<br>
                    <input type="radio" name="status" value="sold" formControlName="status"> Sold<br>
                    <input type="radio" name="status" value="pending" formControlName="status"> Pending<br>
                    <input type="radio" name="status" value="return" formControlName="status"> Return
                </form>
                <!-- <div class="btnnns">
                    <div class="flexProp">
                        <button type="submit" class="btn btn-danger btn-return" style="width: auto;" (click)="hideModal('changeStatus')">Cancel</button>
                        <button class="btn btn-success paynow" type="submit" (click)="changeProductStatus()"
                            [disabled]="changeStatusForm.invalid">Submit</button>
                    </div>
                </div> -->
            </div>
            <div class="modal-footer" style="border: none !important;">
                <div class="retur-product">
                    <button type="button" class="btn btn-danger btn-return" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success paynow btn-return" (click)="changeProductStatus()"
                        [disabled]="changeStatusForm.invalid">Submit </button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal End -->